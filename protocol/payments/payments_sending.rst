.. _protocol-payments-sending:

Sending payments
================

:ref:`Demand-Side Platform <protocol-definitions-dsp>` is expected to pay for displayed/converted advertisement by 
sending :ref:`ADS <protocol-definitions-ads>` payments to one or more :ref:`Supply-Side Platforms <protocol-definitions-ssp>`.

Every hour :ref:`Demand-Side Infrastructure <protocol-definitions-dsi>` generates a :ref:`Payment Report <protocol-definitions-paymentreport>`
which allocates the appropriate amount of :ref:`ADS <protocol-definitions-ads>` that :ref:`Demand-Side Platform <protocol-definitions-dsp>` needs to pay 
to a specific :ref:`Supply-Side Platform <protocol-definitions-ssp>` for utilizing its :ref:`Sites <protocol-definitions-site>` within the last one-hour timeframe.

It is important for :ref:`Demand-Side Platform <protocol-definitions-dsp>` to store the generated :ref:`Payment Reports <protocol-definitions-paymentreport>` 
because :ref:`Supply-Side Platforms <protocol-definitions-ssp>` are expected to request those report upon receiving their payments.

The actual task of generating a :ref:`Payment Report <protocol-definitions-paymentreport>` is delegated 
by :ref:`Demand-Side Platform <protocol-definitions-dsp>` to its :ref:`Ad Pay Module <protocol-definitions-apm>`.

However, to complete this task :ref:`Ad Pay Module <protocol-definitions-apm>` needs to receive from :ref:`Demand-Side Platform <protocol-definitions-dsp>` the following information:

* All :ref:`Impression Events <protocol-definitions-impression>` received by :ref:`Demand-Side Platform <protocol-definitions-dsp>` from all :ref:`Supply-Side Agents <protocol-definitions-ssa>` associated with a given :ref:`Supply-Side Platform <protocol-definitions-ssp>` within the last one-hour timeframe
* The corresponding :ref:`Context Data <protocol-definitions-contextdata>` retrieved by :ref:`Demand-Side Platform <protocol-definitions-dsp>` from its :ref:`Context Infrastructure <protocol-definitions-contextinfrastructure>` in order to match those :ref:`Impression Events <protocol-definitions-impression>` with specific :ref:`Users <protocol-definitions-user>`, :ref:`Sites <protocol-definitions-site>` and :ref:`Devices <protocol-definitions-device>`

:ref:`Payment Reports <protocol-definitions-paymentreport>` generated by :ref:`Ad Pay Module <protocol-definitions-apm>` become the basis for :ref:`Demand-Side Platform <protocol-definitions-dsp>` to proceed with executing the payments.

.. container:: protocol

  Based on the data contained in the :ref:`Payment Report <protocol-definitions-paymentreport>`, :ref:`Demand-Side Platform <protocol-definitions-dsp>` uses 
  :ref:`Adshares Blockchain <protocol-definitions-blockchain>` to send an :ref:`ADS <protocol-definitions-ads>` payment to a given :ref:`Supply-Side Platform <protocol-definitions-ssp>`,  
  by transferring the appropriate amount of :ref:`ADS <protocol-definitions-ads>` to the :ref:`Supply-Side Platform <protocol-definitions-ssp>`'s :ref:`ADS Account <protocol-definitions-account>` address.

.. note::
  :ref:`Demand-Side Platform <protocol-definitions-dsp>` knows the :ref:`ADS Account <protocol-definitions-account>` address of a given :ref:`Supply-Side Platform <protocol-definitions-ssp>`, 
  as it has already been retrieved during the :doc:`Synchronization <../synchronization/index>` stage.
  
Refer to the following guide for furhter details on the recommended :ref:`sending operation <protocol-payments-sending-operation>`.

.. toctree::
    :hidden:

    payments_sending_execution